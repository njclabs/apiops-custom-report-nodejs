<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <style>
            table {
              border-collapse: collapse;
              border-spacing: 0;
              width: 100%;
              border: 1px solid #ddd;
            }
            
            th, td {
              text-align: left;
              padding: 16px;
            }
            
            tr:nth-child(even) {
              background-color: #f2f2f2;
            }

           
           .edit-issue form{
              max-width: 400px;
              margin: 0 auto;  
              border: 1px solid rgb(189, 189, 199);
              padding: 10px;
            }

            .edit-issue input,
            .edit-issue textarea{
              display: block;
              width: 100%;
              margin: 10px 0;
              padding: 8px;
            }

            textarea{
              height: 100px;
            }


            .edit-issue label {
              display: block;
              margin-top: 24px;
            }

            .edit-issue button{
              margin-top: 20px;
              background: rgb(126, 124, 123);
              color:  rgb(232, 219, 248);
              padding: 6px;
              border: 0;
              font-size: 1em;
              cursor: pointer;
              margin-left: 10px;
              border-radius: 5px;
            }
            </style>
            
        <title>Custom Report| db</title>
    </head>
    <body>
        <table id='tableMain'>
            <tr>
              <th style="display:none;">ID</th>
              <th>Issue Description</th>
              <th>Time taken</th>
              <th>Action</th>
            </tr>

            <% if (dbList.length > 0) { %>
              
              <% dbList.forEach( function(dbInfo) { %>
                <tr >
                  <td id="gfgid" style="display:none;"><%= dbInfo._id %></td>
                  <td id="gfgissue"><%= dbInfo.issue %></td>
                  <td id="gfgtime"><%= dbInfo.time %></td>

                  <!-- <% if (dbInfo.time == 0) { %>
                    <//td><a href="/dbIssues/time/<%= dbInfo._id%>" target= "dbRecordDisplay">Edit</a></td>
                    <td><button type="button" id="btnDBEdit" class="gfgselect  btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Edit</button></td>
                  <% } else { %>
                    <td>Edit</td>
                  <% } %> -->
                  <td><button type="button" id="btnDBEdit" class="gfgselect  btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Edit</button></td>
                 
                </tr>
                
              <% }) %>
            <% } else {%>

              <p>Records not available</p>

            <% } %>
          </table>

          <!-- Pass data from the selected row to the model-->
          <!-- https://www.geeksforgeeks.org/how-to-show-contents-of-selected-row-of-a-table-in-bootstrap-model-using-jquery/-->
          <script> 
            $(function () { 
                // ON SELECTING ROW 
                $("#btnDBEdit").click(function () { 
   //FINDING ELEMENTS OF ROWS AND STORING THEM IN VARIABLES 
                    var getid = 
             $(this).parents("tr").find("#gfgid").text(); 
                    var getissue = 
             $(this).parents("tr").find("#gfgissue").text(); 
                    var gettime = 
             $(this).parents("tr").find("#gfgtime").text(); 
                    
                    var p = ""; 
                    // CREATING DATA TO SHOW ON MODEL 
                    p +=  
                    "<label>ID</label> <input type='text'  id='id'  name='id' readonly='readonly' value=" + getid +">"
                    p += 
                    "<label>Issue</label> <textarea id='issue' name='issue' readonly='readonly'>"+ getissue + "</textarea>"
                    p +=  
                    "<label>Time</label> <input type='number'  id='time'  name='time' value=" + gettime +"  >"

                    p +=  
                    "<input type='hidden' id='prevTime' name='prevTime' value=" + gettime +"  >"
                  
                   
                    //CLEARING THE PREFILLED DATA 
                    $("#divGFG").empty(); 
                    //WRITING THE DATA ON MODEL 
                    $("#divGFG").append(p); 
                }); 
            }); 
        </script> 

          <!-- Modal  id="myModal"-->
        <div class="modal fade edit-issue"  id='myModal' role="dialog">
          <div class="modal-dialog modal-lg">
            <form action="/dbIssues/edit" method="post" target= "dbRecordDisplay">
              
            <div class="modal-content">


             <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Edit the time</h4>
              </div>
              <div class="modal-body">
                
                <div class="GFGclass" id="divGFG"></div>
            
                  
                  <!-- <label>Issue</label>
                  <textarea id="issue" readonly="readonly">this is the contnent</textarea>
                  <label>Time</label>
                  <input type="number"  id="time"  name="time"  > -->
                                
                 
                
              </div>

            
              <div class="modal-footer">
                <button type="submit" id="savebtn" value="Submit" class="btn btn-default" >Save</button>
                <button type="reset" id="cancelbtn" value="Reset" class="btn btn-default" data-dismiss="modal">Cancel</button>  
      
              </div>

            </div>
          </form>
          </div>
        </div> 

        

        <!-- Jquery to display pop up using alert-->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"> </script>
        <script>		
          $(document).ready(function () {	
              //=================================================================
              //click on table body
              //$("#tableMain tbody tr").click(function () {
              $('#tableMain tbody').on('click', 'tr', function() {
                //get row contents into an array
                          var tableData = $(this).children("td").map(function() {
                              return $(this).text();
                          }).get();
                          var td=tableData[0] +  '*' +  tableData[1] + '*' + tableData[2] + '*' ;
                          alert(td);
              });
              
              $("#thebutton").click(function () {
                $('#tableMain > tbody').append('<tr class="datarow"><td>11111</td><td>22222</td><td>33333</td><td>44444</td><td>55555</td></tr>')
              })
            });	
          </script> -->

    </body>
</html> 